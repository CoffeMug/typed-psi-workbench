%***********************************************************
%
%	Stuff stolen from Alan Jeffrey
%
%***********************************************************
\makeatletter

%\newdimen\arrayrowsep
%\def\@xarraycr{\@ifnextchar[{\@argarraycr}{\@argarraycr[\arrayrowsep]}}
%\arrayrowsep\jot

%\def\andthen{\@transition\rightarrowfill}
%\def\goesto{\@transition\rightarrowfill}
%\def\Goesto{\@transition\Rightarrowfill}
%\def\ngoesto{\@transition\nrightarrowfill}
%\def\sgoesto{\@transition\mapstofill}
%\def\nsgoesto{\@transition\nmapstofill}
%\def\hgoesto{\@transition\hookarrowfill}
%\def\nhgoesto{\@transition\nhookarrowfill}
%\def\@transition#1{\@ifnextchar[{\@@transition{#1}}{\@@transition{#1}[]}}

\newcommand{\goesto}[1]{\@@transition\rightarrowfill{#1}}
\newcommand{\Goesto}[1]{\@@transition\Rightarrowfill{#1}}
\newcommand{\Goestoplus}[1]{\@@transition\Rightarrowplusfill{#1}}
\newcommand{\Goestotrad}[1]{\@@transition\Hookarrowfill{#1}}
\newcommand{\sgoesto}[1]{\@@transition\mapstofill{#1}}
\newcommand{\Sgoesto}[1]{\@@transition\Mapstofill{#1}}

\newbox\@transbox
\newbox\@arrowbox
\def\Rightarrowfill{$\m@th\mathord=\mkern-6mu%
  \cleaders\hbox{$\mkern-2mu\mathord=\mkern-2mu$}\hfill
  \mkern-6mu\mathord=\mkern-6mu\mathord\Rightarrow$}
\def\Hookarrowfill{$\m@th\mathord\lhook\mathord=\mkern-16mu%
  \cleaders\hbox{$\mkern-2mu\mathord=\mkern-2mu$}\hfill
  \mkern-6mu\mathord=\mkern-6mu\mathord\Rightarrow$}
\def\Rightarrowplusfill{$\m@th\mathord=\mkern-6mu%
  \cleaders\hbox{$\mkern-2mu\mathord=\mkern-2mu$}\hfill
  \mkern-6mu\mathord=\mkern-6mu\mathord\Rightarrow_+$}
\def\mapstofill{$\m@th\mathord\mapstochar\mathord-\mkern-6mu%
  \cleaders\hbox{$\mkern-2mu\mathord-\mkern-2mu$}\hfill
  \mkern-6mu\mathord\rightarrow$}
\def\Mapstofill{$\m@th\mathord|\mkern-3mu\mathord=\mkern-6mu%
  \cleaders\hbox{$\mkern-2mu\mathord=\mkern-2mu$}\hfill
  \mkern-6mu\mathord=\mkern-6mu\mathord\Rightarrow$}
\def\hookarrowfill{$\m@th\mathord\lhook\mathord-\mkern-16mu%
  \cleaders\hbox{$\mkern-2mu\mathord-\mkern-2mu$}\hfill
  \mkern-6mu\mathord\rightarrow$}
\def\nhookarrowfill{$\m@th\mathord\lhook\mathord-\mkern-16mu%
  \cleaders\hbox{$\mkern-2mu\mathord-\mkern-2mu$}\hfill
  \mkern-6mu\mathord\not\mathord-\mkern-16mu
  \cleaders\hbox{$\mkern-2mu\mathord-\mkern-2mu$}\hfill
  \mkern-6mu\mathord\rightarrow$}
\def\nrightarrowfill{$\m@th\mathord-\mkern-6mu%
  \cleaders\hbox{$\mkern-2mu\mathord-\mkern-2mu$}\hfill
  \mkern-6mu\mathord\not\mathord-\mkern-6mu
  \cleaders\hbox{$\mkern-2mu\mathord-\mkern-2mu$}\hfill
  \mkern-6mu\mathord\rightarrow$}
\def\nmapstofill{$\m@th\mathord\mapstochar\mathord-\mkern-6mu%
  \cleaders\hbox{$\mkern-2mu\mathord-\mkern-2mu$}\hfill
  \mkern-6mu\mathord\not\mathord-\mkern-6mu
  \cleaders\hbox{$\mkern-2mu\mathord-\mkern-2mu$}\hfill
  \mkern-6mu\mathord\rightarrow$}
\def\@@transition#1#2%
   {\setbox\@transbox\hbox
      {\strut\hskip0.25em$\scriptstyle#2$\hskip0.35em}
   \ifdim\wd\@transbox<1.5em
      \setbox\@transbox\hbox to 1.5em{\hfil\box\@transbox\hfil}\fi
   \setbox\@arrowbox\hbox to \wd\@transbox{#1}
%   \ht\@arrowbox\z@\dp\@arrowbox\z@
%   \setbox\@transbox\hbox{$\mathop{\box\@arrowbox}\limits^{\box\@transbox}$}
%   \ht\@transbox\z@\dp\@transbox\z@
% Fixed by Jan Nystr\"om:
   \ht\@arrowbox 0.2\ht\@arrowbox\dp\@arrowbox\z@
   \ht\@transbox 0.6\ht\@transbox
   \setbox\@transbox\hbox{$\mathop{\box\@arrowbox}\limits^{\box\@transbox}$}
   \mathrel{\box\@transbox}}

\makeatother
%***********************************************************
%
%	End of stuff stolen from Alan Jeffrey
%
%***********************************************************
